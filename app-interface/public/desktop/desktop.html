<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ambient Desktop Prototype</title>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #1e1e1e url('./icons/saved-screenshots-desktop.jpg') no-repeat center center fixed;
      background-size: contain;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    
    
    body::before {
      display: none;
    }

    
    .dock {
      position: fixed;
      bottom: 120px;
      left: 50px;
      display: flex;
      align-items: flex-end;
    }

    .widget {
      width: 58px;
      height: 58px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      position: relative;
      margin-left: -8px;
      box-shadow: 0 5px 10px rgba(0,0,0,0.25);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .widget img {
      width: 60%;
      height: 60%;
      object-fit: contain;
      pointer-events: none;
    }

    
    .calendar {
      background: none;
      box-shadow: none;
      border: none;
      width: auto;
      height: auto;
      transform: translateY(10px);
      margin-right: 6px;
    }
    .calendar img { width: 60px; height: auto; }

    
    .calendar-popup {
      position: absolute;
      background: white;
      border-radius: 10px;
      padding: 12px 18px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
      font-size: 15px;
      font-weight: bold;
      display: none;
      flex-direction: column;
      z-index: 30;
      min-width: 220px;
    }
    .calendar-popup.show { display: flex; }
    .calendar-popup .close-btn {
      position: absolute;
      top: 6px;
      right: 10px;
      cursor: pointer;
      font-size: 16px;
      color: black;
    }
    .calendar-popup .line {
      margin: 6px 0;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: normal;
    }
    .calendar-popup img { width: 22px; height: 22px; }
    .calendar-popup .status-title {
      text-decoration: underline;
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 4px;
    }

    
    .assignment { background: #8fd08a; border: 4px solid #5baa52; }
    .quiz       { background: #6dd5e0; border: 4px solid #3aa6b0; }
    .studying   { background: #f296c6; border: 4px solid #cc5d97; }
    .clean      { background: #dadada; border: 4px solid #a1a1a1; }
    .group      { background: #b79de8; border: 4px solid #8b6dc9; }

    
    .assignment { transform: translateY(0)  scale(1.3); z-index: 5; }  
    .quiz       { transform: translateY(4px) scale(1.15); z-index: 4; } 
    .group      { transform: translateY(8px) scale(1.05); z-index: 3; } 
    .studying   { transform: translateY(10px) scale(0.95); z-index: 2; } 
    .clean      { transform: translateY(12px) scale(0.85); z-index: 1; } 

    
    @keyframes bubbleBlink {
      0%, 100% { transform: scale(1.3); box-shadow: 0 0 10px rgba(255,255,255,0.5); }
      50%      { transform: scale(1.45); box-shadow: 0 0 30px rgba(255,255,255,1); }
    }
    .upcoming { animation: bubbleBlink 2s infinite ease-in-out; }

    
    .widget.fade-out {
      opacity: 0;
      transform: scale(0.5) translateY(20px);
      transition: all 0.5s ease;
    }
    
    .widget.hidden {
      display: none;
    }

    
    .widget-popup {
      position: absolute;
      bottom: 210px;
      left: 50%;
      transform: translateX(-30%);
      display: none;
      align-items: center;
      justify-content: space-between;
      padding: 10px 18px;
      border-radius: 22px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.25);
      color: black;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
      white-space: nowrap;
    }
    .widget-popup.show { display: flex; }
    .widget-popup.blur { filter: blur(4px); }

    .popup-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .check-box {
      width: 28px;
      height: 28px;
      background: white;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      cursor: pointer;
    }
    .check-box img { width: 18px; height: 18px; }
    .edit-icon { width: 22px; height: 22px; margin-left: 8px; }

    
    .confirm-popup {
      position: absolute;
      bottom: 260px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      border-radius: 16px;
      padding: 15px 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      text-align: center;
      font-weight: bold;
      display: none;
      flex-direction: column;
      align-items: center;
      z-index: 15;
    }
    .confirm-popup.show { display: flex; }
    .confirm-buttons {
      margin-top: 10px;
      display: flex;
      gap: 10px;
    }
    .confirm-btn {
      padding: 6px 16px;
      border-radius: 6px;
      border: 2px solid;
      font-weight: bold;
      cursor: pointer;
      font-size: 14px;
    }
    .yes-btn { background: #90ee90; border-color: #2b8a2b; color: #2b8a2b; }
    .no-btn  { background: #ffb3b3; border-color: #b30000; color: #b30000; }

    
    .done-popup {
      position: absolute;
      bottom: 260px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      border-radius: 16px;
      padding: 15px 25px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      text-align: center;
      font-weight: bold;
      display: none;
      align-items: center;
      gap: 12px;
      z-index: 20;
      min-height: 50px;
    }
    .done-popup img { width: 48px; height: 48px; }
    .done-popup.show { display: flex; }

    
    .timeline-container {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      width: 40%;
      max-width: 500px;
      height: 14px;
      background: white;
      border: 1px solid rgba(0,0,0,0.6);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      overflow: visible;
      cursor: pointer;
    }
    .event {
      position: absolute;
      top: 0;
      height: 100%;
      background: #1e1e1e;
      z-index: 2;
    }
    .past-fill {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: rgba(128,128,128,0.5);
      z-index: 3;
      width: 0;
      transition: width 1s linear;
      pointer-events: none; 
    }
    .current-time {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 32px;
      height: 32px;
      background: white;
      border: 1.5px solid black;
      border-radius: 50%;
      z-index: 5;
    }

    .time-labels {
      position: fixed;
      bottom: 70px;
      left: 50%;
      transform: translateX(-50%);
      width: 40%;
      max-width: 500px;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #000;
      font-weight: 600;
    }

    
    .event-popup {
      position: absolute;
      background: white;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      padding: 8px 12px;
      font-size: 14px;
      z-index: 50;
      display: none;
      flex-direction: column;
      animation: fadeIn 0.25s ease-in-out;
      min-width: 160px;
    }
    .event-popup.show { display: flex; }

    .event-popup table { width: 100%; border-collapse: collapse; font-size: 14px; }
    .event-popup th, .event-popup td { padding: 2px 4px; text-align: left; }
    .event-popup th { border-bottom: 1px solid #ddd; font-weight: bold; }
    .event-row.past td { color: #9a9a9a; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>

  
  <div class="dock">
    <div class="widget calendar" id="calendarWidget">
      <img src="./icons/calender.svg" alt="Calendar" />
    </div>

    <div class="widget assignment upcoming" data-color="#8fd08a" data-border="#5baa52" data-title="ECSE 424 Deliverable #3 - due Oct 31, 2025 - 11:59 PM">
      <img src="./icons/assignment.svg" alt="Assignment" />
    </div>

    <div class="widget quiz" data-color="#6dd5e0" data-border="#3aa6b0" data-title="Databases Quiz – Nov 4, 2025 10:00 AM">
      <img src="./icons/quiz.svg" alt="Quiz" />
    </div>

    <div class="widget group" data-color="#b79de8" data-border="#8b6dc9" data-title="ECSE 424 team meeting - Nov 4th, 2025 - 3:30 PM">
      <img src="./icons/group discussion.svg" alt="Group Discussion" />
    </div>

    <div class="widget studying" data-color="#f296c6" data-border="#cc5d97" data-title="Calculus exam - Nov 6, 2025 - 6:00 PM">
      <img src="./icons/studying.svg" alt="Studying" />
    </div>

    <div class="widget clean" data-color="#dadada" data-border="#a1a1a1" data-title="Vacuum before guests arrive - Nov 7, 2025 - 8:00 PM">
      <img src="./icons/clean.svg" alt="Clean" />
    </div>
  </div>

  
  <div class="calendar-popup" id="calendarPopup">
    <div class="close-btn" id="calendarClose">×</div>
    <div class="status-title">Today’s Status:</div>
    <div class="line"><img src="./icons/completed.svg" alt="Completed"> Completed: <span id="completedCount">0</span></div>
    <div class="line"><img src="./icons/deadline.svg" alt="Deadline"> Deadlines left: <span id="deadlineCount">0</span></div>
  </div>

  
  <div class="widget-popup" id="widgetPopup">
    <div class="popup-left">
      <div class="check-box" id="checkBox">
        <img src="./icons/check.svg" alt="Check" />
      </div>
      <span id="popupText"></span>
    </div>
    <img src="./icons/edit.svg" class="edit-icon" alt="Edit" />
  </div>

  
  <div class="confirm-popup" id="confirmPopup">
    <div>Mark as done?</div>
    <div class="confirm-buttons">
      <button class="confirm-btn yes-btn" id="yesBtn">YES</button>
      <button class="confirm-btn no-btn" id="noBtn">NO</button>
    </div>
  </div>

  
  <div class="done-popup" id="donePopup">
    <span id="doneText"></span>
    <img src="./icons/done.svg" alt="Done" />
  </div>

  
  <div class="timeline-container" id="timeline">
    
    <div class="event" id="event1"></div>
    <div class="event" id="event2"></div>
    <div class="event" id="event3"></div>
    <div class="event" id="event4"></div>

    <div class="past-fill" id="pastFill"></div>
    <div class="current-time" id="currentTime"></div>
  </div>

  <div class="time-labels">
    <span>12 AM</span><span>6 AM</span><span>12 PM</span><span>6 PM</span><span>12 AM</span>
  </div>

  
<div class="event-popup" id="eventPopup">
  <table>
    <tbody id="eventRows">
      
    </tbody>
  </table>
</div>


<script>
  
  function toSeconds(h, m) { return h * 3600 + m * 60; }
  function parseTimeLabel(label) {
    const [time, ampm] = label.trim().split(' ');
    const [hStr, mStr] = time.split(':');
    let h = parseInt(hStr, 10);
    const m = parseInt(mStr, 10);
    if (ampm.toUpperCase() === 'PM' && h !== 12) h += 12;
    if (ampm.toUpperCase() === 'AM' && h === 12) h = 0;
    return toSeconds(h, m);
  }
  function nowSeconds() {
    const d = new Date();
    return toSeconds(d.getHours(), d.getMinutes()) + d.getSeconds();
  }
  function pctOfDay(seconds) { return (seconds / 86400) * 100; }

  
  const eventData = [
    { name: "ECSE 424",         start: "8:30 AM",  end: "11:30 AM" },
    { name: "Badminton Match",  start: "12:30 PM", end: "1:30 PM"  },
    { name: "Team Meeting",     start: "3:30 PM",  end: "5:30 PM"  },
    { name: "Gym",              start: "6:00 PM",  end: "8:30 PM"  },
  ];

  
  function updateCurrentTime() {
    const total = nowSeconds();
    const percent = pctOfDay(total);
    document.getElementById("currentTime").style.left = percent + "%";
    document.getElementById("pastFill").style.width = percent + "%";
  }
  updateCurrentTime();
  setInterval(updateCurrentTime, 60000);

  
  function renderEventBlocks() {
    eventData.forEach((ev, idx) => {
      const start = parseTimeLabel(ev.start);
      const end   = parseTimeLabel(ev.end);
      const leftPct  = pctOfDay(start);
      const widthPct = pctOfDay(end - start);
      const el = document.getElementById(`event${idx+1}`);
      if (el) {
        el.style.left = leftPct + "%";
        el.style.width = widthPct + "%";
        el.dataset.title = ev.name;
        el.dataset.time  = `${ev.start} – ${ev.end}`;
      }
    });
  }
  renderEventBlocks();
  addEventClickHandlers();

  
  const eventPopup = document.getElementById("eventPopup");
  const eventRows  = document.getElementById("eventRows");
  let popupTimer = null;

  function populateEventTable() {
    eventRows.innerHTML = "";
    const now = nowSeconds();
    eventData.forEach(ev => {
      const endSec = parseTimeLabel(ev.end);
      const tr = document.createElement("tr");
      tr.className = "event-row" + (endSec <= now ? " past" : "");
      const tdName = document.createElement("td");
      const tdTime = document.createElement("td");
      tdName.textContent = ev.name;
      tdTime.textContent = `${ev.start} – ${ev.end}`;
      tr.appendChild(tdName);
      tr.appendChild(tdTime);
      eventRows.appendChild(tr);
    });
  }
  populateEventTable();



  function addEventClickHandlers() {
    eventData.forEach((ev, idx) => {
      const eventEl = document.getElementById(`event${idx+1}`);
      if (eventEl) {
        eventEl.addEventListener("click", (e) => {
          e.stopPropagation();
          showSingleEventPopup(ev, e.target);
        });
        eventEl.style.cursor = "pointer";
      }
    });
  }

  function showSingleEventPopup(eventInfo, clickedElement) {
    clearTimeout(popupTimer);
    
    eventRows.innerHTML = `
      <tr class="event-row">
        <td colspan="2" style="text-align: center; font-weight: bold;">${eventInfo.name}</td>
      </tr>
      <tr class="event-row">
        <td colspan="2" style="text-align: center;">${eventInfo.start} – ${eventInfo.end}</td>
      </tr>
    `;
    
    const rect = clickedElement.getBoundingClientRect();
    eventPopup.style.left = (rect.left + rect.width / 2) + "px";
    eventPopup.style.top = (rect.top - 100) + "px";
    eventPopup.style.transform = "translateX(-50%)";
    eventPopup.classList.add("show");
    
    popupTimer = setTimeout(() => eventPopup.classList.remove("show"), 5000);
  }

  eventPopup.addEventListener("mouseenter", () => clearTimeout(popupTimer));
  eventPopup.addEventListener("mouseleave", () => {
    clearTimeout(popupTimer);
    popupTimer = setTimeout(() => eventPopup.classList.remove("show"), 7000);
  });

  document.addEventListener("click", (e) => {
    if (!eventPopup.contains(e.target)) eventPopup.classList.remove("show");
  });

  
  const widgets = document.querySelectorAll(".widget:not(.calendar)");
  const widgetPopup = document.getElementById("widgetPopup");
  const popupText = document.getElementById("popupText");
  const checkBox = document.getElementById("checkBox");
  const confirmPopup = document.getElementById("confirmPopup");
  const donePopup = document.getElementById("donePopup");
  const yesBtn = document.getElementById("yesBtn");
  const noBtn = document.getElementById("noBtn");
  const doneText = document.getElementById("doneText");
  const calendar = document.getElementById("calendarWidget");
  const calendarPopup = document.getElementById("calendarPopup");
  const calendarClose = document.getElementById("calendarClose");
  const completedCount = document.getElementById("completedCount");
  const deadlineCount = document.getElementById("deadlineCount");

  widgets.forEach(w => w.dataset.done = "false");

  let completed = 0;
  const totalTasks = widgets.length;
  function refreshCounts() {
    completedCount.textContent = completed;
    deadlineCount.textContent = totalTasks - completed;
  }
  refreshCounts();

  let activeWidget = null;

  widgets.forEach(w => {
    w.addEventListener("click", (e) => {
      e.stopPropagation();
      const color = w.dataset.color;
      const border = w.dataset.border;
      const title = w.dataset.title;
      popupText.textContent = title;
      widgetPopup.style.background = color;
      widgetPopup.style.border = `3px solid ${border}`;
      widgetPopup.style.left = (w.getBoundingClientRect().left + w.offsetWidth / 2 + 30) + "px";
      widgetPopup.classList.add("show");
      activeWidget = w;
    });
  });

  checkBox.addEventListener("click", (e) => {
    e.stopPropagation();
    widgetPopup.classList.add("blur");
    const popupRect = widgetPopup.getBoundingClientRect();
    const confH = confirmPopup.offsetHeight || 84;
    confirmPopup.style.left = (popupRect.left + popupRect.width / 2) + "px";
    confirmPopup.style.top  = (popupRect.top - confH - 12) + "px";
    confirmPopup.style.transform = "translateX(-50%)";
    confirmPopup.classList.add("show");
  });

  yesBtn.addEventListener("click", () => {
    confirmPopup.classList.remove("show");
    widgetPopup.classList.remove("blur");
    widgetPopup.classList.remove("show");

    if (activeWidget && activeWidget.dataset.done !== "true") {
      activeWidget.dataset.done = "true";
      completed += 1;
      refreshCounts();
      
      const widgetRect = activeWidget.getBoundingClientRect();
      donePopup.style.left = (widgetRect.left + widgetRect.width / 2 + 60) + "px";
      donePopup.style.top  = (widgetRect.top - 100) + "px";
      donePopup.style.transform = "translateX(-50%)";
      doneText.textContent = "Marked as done";
      donePopup.classList.add("show");
      
      activeWidget.classList.add("fade-out");
      
      setTimeout(() => {
        activeWidget.classList.add("hidden");
        reorganizeWidgets();
        donePopup.classList.remove("show");
      }, 500);
    }
  });
  
  function reorganizeWidgets() {
    const widgets = Array.from(document.querySelectorAll('.widget:not(.hidden):not(.calendar)'));
    
    widgets.forEach(w => {
      w.classList.remove('upcoming');
    });
    
    const scales = [
      { translateY: 0, scale: 1.3, zIndex: 5 },
      { translateY: 4, scale: 1.15, zIndex: 4 },
      { translateY: 8, scale: 1.05, zIndex: 3 },
      { translateY: 10, scale: 0.95, zIndex: 2 },
      { translateY: 12, scale: 0.85, zIndex: 1 }
    ];
    
    widgets.forEach((widget, index) => {
      if (index < scales.length) {
        const s = scales[index];
        widget.style.transform = `translateY(${s.translateY}px) scale(${s.scale})`;
        widget.style.zIndex = s.zIndex;
        
        if (index === 0) {
          widget.classList.add('upcoming');
        }
      }
    });
  }

  noBtn.addEventListener("click", () => {
    confirmPopup.classList.remove("show");
    widgetPopup.classList.remove("blur");
  });

  document.addEventListener("click", (e) => {
    if (!widgetPopup.contains(e.target) && !confirmPopup.contains(e.target) && !donePopup.contains(e.target)) {
      widgetPopup.classList.remove("show");
      confirmPopup.classList.remove("show");
      donePopup.classList.remove("show");
    }
  });

  calendar.addEventListener("click", (e) => {
    e.stopPropagation();
    
    const calendarRect = calendar.getBoundingClientRect();
    calendarPopup.style.left = (calendarRect.left + 20) + "px";
    calendarPopup.style.top = (calendarRect.top - 150) + "px";
    calendarPopup.style.transform = "translateX(0)";
    
    calendarPopup.classList.toggle("show");
  });
  calendarClose.addEventListener("click", () => calendarPopup.classList.remove("show"));
  document.addEventListener("click", (e) => {
    if (!calendarPopup.contains(e.target) && !calendar.contains(e.target)) {
      calendarPopup.classList.remove("show");
    }
  });
</script>

</body>
</html>
